### 2、统计商品的热门品类Top10

在实际的工作中如何使用这些API实现具体的需求: 这些需求是电商网站的真实需求，所以在实现功能前，咱们必须先将数据准备好。

### **数据准备**以及数据说明

> **每行数据的基本说明**
>
> ![image-20220624095924357](https://tiancy-images.oss-cn-beijing.aliyuncs.com/img/202206240959488.png) 
>
> **详细字段说明**
>
> | 编号 | 字段名称           | 字段类型 | 字段含义                   |
> | ---- | ------------------ | -------- | -------------------------- |
> | 1    | date               | String   | 用户点击行为的日期         |
> | 2    | user_id            | Long     | 用户的ID                   |
> | 3    | session_id         | String   | Session的ID                |
> | 4    | page_id            | Long     | 某个页面的ID               |
> | 5    | action_time        | String   | 动作的时间点               |
> | 6    | search_keyword     | String   | 用户搜索的关键词           |
> | 7    | click_category_id  | Long     | 某一个商品品类的ID         |
> | 8    | click_product_id   | Long     | 某一个商品的ID             |
> | 9    | order_category_ids | String   | 一次订单中所有品类的ID集合 |
> | 10   | order_product_ids  | String   | 一次订单中所有商品的ID集合 |
> | 11   | pay_category_ids   | String   | 一次支付中所有品类的ID集合 |
> | 12   | pay_product_ids    | String   | 一次支付中所有商品的ID集合 |
> | 13   | city_id            | Long     | 城市 id                    |

```sql
-- 部分数据展示
点击时间(1)、用户id(2)、sessionID(3)、页面ID(4)、动作时间(5)、搜索关键字(6)、某商品品类ID(7)、商品ID(8)、一次订单中所有品类ID集合(9)、一次订单所有商品ID集合(10)、一次订单中所有品类ID支付集合(11)、一次订单中所有商品ID支付集合(12)、城市ID(13)
-- 搜索
2019-07-17_95_26070e87-1ad7-49a3-8fb3-cc741facaddf_37_2019-07-17 00:00:02_手机_-1_-1_null_null_null_null_3
-- 点击行为
2019-07-17_95_26070e87-1ad7-49a3-8fb3-cc741facaddf_48_2019-07-17 00:00:10_null_16_98_null_null_null_null_19
-- 下单行为
2019-07-17_39_e17469bf-0aa1-4658-9f76-309859dcd641_47_2019-07-17 00:02:59_null_-1_-1_15,9,3_30_null_null_21
-- 付款行为
2019-07-17_39_e17469bf-0aa1-4658-9f76-309859dcd641_4_2019-07-17 00:02:56_null_-1_-1_null_null_15,1,16_52,77_6
```

> **上面的数据图是从数据文件中截取的一部分内容，表示为电商网站的用户行为数据，主要包含用户的4种行为：<strong style="color:#ff0000;">搜索，点击，下单，支付</strong> 。数据规则如下：**
>
> - 每一行数据表示用户的一次行为，这个行为只能是4种行为的一种
>
> - 如果搜索关键字为null,表示数据不是搜索数据
>
> - 如果点击的品类ID和产品ID为-1，表示数据不是点击数据
>
> - 针对于下单行为，一次可以下单多个商品，所以品类ID和产品ID可以是多个，id之间采用逗号分隔，如果本次不是下单行为，则数据采用null表示
>
> - 支付行为和下单行为类似

### 需求描述
 
 统计出每个品类ID的点击数、下单数、支付数.并按照 点击数、下单数、支付数这个顺序,进行降序排序. 结果取前10条
 
 